//  Top score modes to be evaluated during RDO according to PU size
//  NULL,4x4,8x8,16x16,32x32,64x64
static Int topScore_5B[2][6] = {{-1,3,3,2,1,1},{-1,3,3,2,1,1}};   //{POLAR},{MID_MOLAR}
static Int topScore_3B[6] = {-1, 3,3,2,1,1};   //{POLAR}

//  Mean occurrence rate per mode for FIVE BANDS. Considering upper and lower. {POLAR},{MID_POLAR}
static Float fixed_rates_5B_64[2][35] = {{0.23971,0.12907,0.01057,0.00973,0.01092,0.01220,0.01536,0.01671,0.02163,0.04026,0.34318,0.03640,0.02148,0.01435,0.00894,0.00430,0.00236,0.00133,0.00065,0.00046,0.00059,0.00052,0.00068,0.00094,0.00111,0.00107,0.01512,0.00143,0.00205,0.00249,0.00303,0.00335,0.00486,0.00710,0.01604},
                             {0.37522,0.15171,0.01513,0.01449,0.01553,0.01589,0.01826,0.01864,0.01398,0.01283,0.09224,0.01289,0.01394,0.01455,0.01172,0.00885,0.00618,0.00372,0.00282,0.00269,0.00308,0.00405,0.00576,0.00735,0.00824,0.00654,0.03856,0.00775,0.00841,0.00982,0.01112,0.01142,0.01211,0.01507,0.02945}};
static Float fixed_rates_5B_32[2][35] = {{0.24277,0.15138,0.00497,0.00423,0.00519,0.00663,0.01113,0.02073,0.04134,0.08927,0.22709,0.08282,0.03490,0.01600,0.00840,0.00492,0.00319,0.00230,0.00157,0.00130,0.00110,0.00091,0.00087,0.00091,0.00088,0.00107,0.01371,0.00108,0.00138,0.00140,0.00174,0.00190,0.00277,0.00398,0.00616},
                             {0.34924,0.21139,0.01300,0.01264,0.01463,0.01644,0.02125,0.02498,0.02478,0.02360,0.04619,0.02030,0.01900,0.01697,0.01300,0.01030,0.00830,0.00722,0.00609,0.00569,0.00475,0.00409,0.00353,0.00354,0.00338,0.00439,0.03877,0.00920,0.00574,0.00639,0.00647,0.00743,0.00915,0.01173,0.01644}};
static Float fixed_rates_5B_16[2][35] = {{0.21187,0.09995,0.00617,0.00705,0.00960,0.01368,0.02411,0.04433,0.07616,0.07354,0.09657,0.07726,0.08071,0.04690,0.02638,0.01606,0.01045,0.00767,0.00534,0.00435,0.00349,0.00314,0.00310,0.00278,0.00270,0.00185,0.01413,0.00158,0.00276,0.00304,0.00351,0.00381,0.00424,0.00498,0.00675},
                             {0.26265,0.15175,0.01419,0.01449,0.01727,0.02053,0.02754,0.03190,0.03351,0.02302,0.02723,0.02236,0.03504,0.03166,0.02592,0.02163,0.01839,0.01729,0.01442,0.01269,0.01082,0.00979,0.00892,0.00795,0.00819,0.00673,0.03498,0.01308,0.00946,0.00912,0.00905,0.00941,0.01084,0.01289,0.01528}};
static Float fixed_rates_5B_8[2][35] =  {{0.16287,0.07553,0.00915,0.00657,0.00915,0.01358,0.02753,0.04798,0.07265,0.07519,0.07852,0.08500,0.08573,0.06294,0.04113,0.02442,0.01530,0.01139,0.01322,0.00637,0.00512,0.00488,0.00423,0.00393,0.00345,0.00266,0.01689,0.00234,0.00263,0.00297,0.00339,0.00407,0.00453,0.00522,0.00947},
                             {0.21347,0.11992,0.01721,0.01309,0.01494,0.01911,0.02640,0.03109,0.03090,0.02450,0.03038,0.02577,0.03599,0.03663,0.03161,0.02610,0.02082,0.01964,0.02549,0.01562,0.01343,0.01391,0.01212,0.01072,0.01020,0.01170,0.04781,0.01645,0.01038,0.01030,0.01044,0.01059,0.01107,0.01314,0.01908}};
static Float fixed_rates_5B_4[2][35] =  {{0.15825,0.06091,0.00720,0.00944,0.01013,0.01425,0.03407,0.04987,0.06651,0.06028,0.07394,0.06649,0.08293,0.07388,0.05885,0.03210,0.02111,0.01969,0.01122,0.01015,0.00635,0.00548,0.00486,0.00402,0.00289,0.00199,0.02144,0.00182,0.00213,0.00248,0.00310,0.00345,0.00420,0.00589,0.00862},
                             {0.20718,0.10251,0.01351,0.01420,0.01333,0.01607,0.02548,0.02688,0.02595,0.02066,0.03602,0.02177,0.03139,0.03578,0.03587,0.02826,0.02502,0.02913,0.02363,0.02408,0.01717,0.01535,0.01509,0.01236,0.01055,0.01089,0.06364,0.01395,0.01064,0.01055,0.01174,0.00991,0.01090,0.01467,0.01588}};

//  Mean occurrence rate per mode for THREE BANDS. Considering upper and lower band
static Float fixed_rates_3B_64[35] = {0.27435, 0.1345, 0.0123, 0.01175, 0.01285, 0.01385, 0.01685, 0.0176, 0.0198, 0.03245, 0.2749, 0.02945, 0.0193, 0.01455, 0.0097, 0.00545, 0.0032, 0.00175, 0.00095, 0.00075, 0.00095, 0.00125, 0.0017, 0.0028, 0.00335, 0.0028, 0.0224, 0.00305, 0.0044, 0.0047, 0.00525, 0.0054, 0.00655, 0.00915, 0.01975};
static Float fixed_rates_3B_32[35] = {0.2737, 0.1695, 0.00695, 0.00665, 0.00775, 0.0092, 0.01405, 0.0225, 0.0378, 0.0712, 0.17435, 0.0654, 0.0313, 0.0171, 0.0103, 0.0067, 0.00475, 0.0037, 0.0028, 0.0023, 0.0019, 0.00165, 0.00145, 0.00145, 0.00145, 0.0017, 0.0197, 0.00205, 0.00235, 0.00255, 0.0028, 0.0033, 0.00445, 0.00615, 0.00905};
static Float fixed_rates_3B_16[35] = {0.2297, 0.1187, 0.03925, 0.0377, 0.03845, 0.03705, 0.0409, 0.04155, 0.05165, 0.04125, 0.0486, 0.0382, 0.04245, 0.0307, 0.0211, 0.01655, 0.01265, 0.01075, 0.0088, 0.0082, 0.0071, 0.0063, 0.0059, 0.0051, 0.00485, 0.0041, 0.0126, 0.0043, 0.0047, 0.0047, 0.0047, 0.0048, 0.00505, 0.00525, 0.00625};
static Float fixed_rates_3B_8[35] =  {0.18685, 0.09405, 0.0122, 0.0095, 0.0127, 0.01755, 0.02895, 0.04275, 0.0563, 0.0534, 0.0571, 0.05855, 0.0657, 0.0539, 0.04055, 0.02785, 0.01915, 0.0157, 0.01795, 0.0096, 0.00815, 0.00845, 0.0074, 0.0064, 0.00545, 0.0043, 0.0251, 0.00485, 0.005, 0.00525, 0.00555, 0.0064, 0.0067, 0.0077, 0.0129};
static Float fixed_rates_3B_4[35] =  {0.1849, 0.08105, 0.00995, 0.01245, 0.013, 0.0169, 0.032, 0.04065, 0.04815, 0.0414, 0.0554, 0.0439, 0.0578, 0.05705, 0.05225, 0.0343, 0.02515, 0.0256, 0.01635, 0.01555, 0.0108, 0.0098, 0.00925, 0.0072, 0.0053, 0.00395, 0.036, 0.00435, 0.0051, 0.0054, 0.00615, 0.0059, 0.00655, 0.00885, 0.01155};

// The following arrays are updated with the statistics for THREE BANDS or FIVE BANDS, depending on the encoding parameters
Float fixed_rates_polar_64[35];
Float fixed_rates_polar_32[35];
Float fixed_rates_polar_16[35];
Float fixed_rates_polar_8[35];
Float fixed_rates_polar_4[35];

Float fixed_rates_mid_polar_64[35];
Float fixed_rates_mid_polar_32[35];
Float fixed_rates_mid_polar_16[35];
Float fixed_rates_mid_polar_8[35];
Float fixed_rates_mid_polar_4[35];


// THE FOLLOWING STATISTICS ARE APPLIED TO ANY NUMBER OF BANDS
//  Correlation between RMD selection and RDO selection. First value is actual correlation, remaining is extrapolated
static Float corrRMD_RDO64[8] = {0.4, 0.35, 0.25,  0,0,0,0,0};
static Float corrRMD_RDO32[8] = {0.45, 0.35, 0.2,  0,0,0,0,0};
static Float corrRMD_RDO16[8] = {0.55, 0.3, 0.15,  0,0,0,0,0};
static Float corrRMD_RDO8[8]  = {0.6, 0.203125, 0.1, 0.05, 0.025, 0.0125, 0.00625, 0.003125};
static Float corrRMD_RDO4[8]  = {0.70006561, 0.21, 0.063, 0.0189, 0.00567, 0.001701, 0.0005103, 0.00015309};
static Float corrRMD_RDO[8]   = {1,1,1,1,1,1,1,1};   // Used when adding the score further

// Extra score added to MPM modes
static Float MPM_SCORE = 0.3;